<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Meteran Maaf</title>
    <link rel="preload" href="styles.css" as="style" />
    <link rel="preload" href="assets/cat/cat-8.png" as="image" />
    <link rel="preload" href="assets/cat/cat-9.png" as="image" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app" data-state="intro">
      <div
        class="screen intro"
        role="dialog"
        aria-modal="true"
        aria-labelledby="intro-title"
        aria-describedby="intro-sub"
      >
        <div class="intro__overlay" aria-hidden="true"></div>
        <div class="intro__content">
          <h1 id="intro-title">
            Karena kamu masih kesel dan males sama aku jadinya aku mau bujuk
            kamu hehehe
          </h1>
          <p id="intro-sub">Tap atau klik untuk mulai sayang.</p>
          <button class="intro__start" type="button">Hayuu mulai</button>
        </div>
      </div>
      <header class="hero" aria-live="polite">
        <div class="hero__cat" aria-hidden="true">
          <img
            src="assets/cat/cat-8.png"
            alt="Ilustrasi kucing sedih tapi berharap"
            id="cat-image"
            width="512"
            height="512"
            data-fallback-src="assets/cat/cat_idle.svg"
            decoding="async"
            loading="eager"
          />
          <div class="cat__sparkle" aria-hidden="true"></div>
        </div>
        <div class="hero__text">
          <h1>Kumpulan Kata Maaf</h1>
          <p class="hero__subtitle">
            Ini kumpulan minta maafku dan aku bujuk kamuu hehehe.
          </p>
        </div>
      </header>
      <main>
        <section class="meter-section" aria-labelledby="meter-label">
          <div class="meter-header">
            <h2 id="meter-label">Apology Meter</h2>
            <span class="meter-value" id="meter-value" aria-live="polite">0%</span>
          </div>
          <div class="meter" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" aria-describedby="meter-label">
            <div class="meter__fill" id="meter-fill"></div>
            <div class="meter__glow"></div>
          </div>
          <button class="button button--primary" id="fill-button" type="button" aria-describedby="fill-hint">Isi dengan Usaha</button>
          <p class="hint" id="fill-hint">Kamu juga bisa tap di ruang kosong untuk maju satu langkah.</p>
        </section>
        <section class="messages" aria-live="polite" aria-label="Pesan permintaan maaf" id="message-list"></section>
        <section class="completion" id="completion" hidden>
          <p class="completion__text" id="completion-text"></p>
          <div class="cta-group" id="cta-group"></div>
        </section>
      </main>
      <footer class="footer">
        <p>Kalau kamu butuh waktu, aku siap menunggu.</p>
        <button class="link" id="reset-progress" type="button">Reset</button>
      </footer>
    </div>

    <dialog id="hug-modal" aria-labelledby="hug-title">
      <form method="dialog">
        <h2 id="hug-title">Pelukan dari Si Kucing</h2>
        <img
          src="assets/cat/cat-9.png"
          alt="Kucing membuka tangan untuk peluk"
          class="modal__image"
          width="512"
          height="512"
          data-fallback-src="assets/cat/cat_hug.svg"
          decoding="async"
          loading="lazy"
        />
        <p>Peyukkk kamuuu, nanti kita peyukk yang lamaa yaaa. sayanggg kamuuuüòò‚ù£Ô∏è‚ù£Ô∏è‚ù£Ô∏è</p>
        <button class="button" value="close">Tutup</button>
      </form>
    </dialog>

    <template id="message-template">
      <article class="message" data-category="">
        <p class="message__text"></p>
      </article>
    </template>

    <template id="heart-template">
      <img src="https://www.svgrepo.com/show/535436/heart.svg" alt="" class="heart" aria-hidden="true" />
    </template>

    <script type="module">
      const version = `${Date.now()}`;
      const html = document.documentElement;
      html.dataset.buildVersion = version;

      const bustLinks = document.querySelectorAll('link[data-cache-bust="styles"]');
      bustLinks.forEach((link) => {
        const baseHref = link.getAttribute('data-base-href') || link.getAttribute('href');
        if (baseHref) {
          link.setAttribute('href', `${baseHref}?v=${version}`);
        }
      });

      import(`./app.js?v=${version}`).catch((error) => {
        console.error('Gagal memuat aplikasi', error);
      });
    </script>
  </body>
</html>
